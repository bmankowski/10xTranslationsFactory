import { supabase } from '../../db/supabase';

export const prerender = false;

const url = Astro.url;
const code = url.searchParams.get('code');
const next = url.searchParams.get('next') || '/dashboard';

if (code) {
  
  
  // Exchange the code for a session
  await supabase.auth.exchangeCodeForSession(code);
}

// Redirect to dashboard or specified next page
return Astro.redirect(next); 